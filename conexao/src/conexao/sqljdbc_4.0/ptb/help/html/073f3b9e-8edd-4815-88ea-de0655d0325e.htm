<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Compreendendo o suporte a SSL</title><meta name="Language" content="pt-br" /><meta name="System.Keywords" content="criptografia" /><meta name="System.Keywords" content="SSL" /><meta name="Microsoft.Help.Id" content="073f3b9e-8edd-4815-88ea-de0655d0325e" /><meta name="Description" content="Ao estabelecer conexão com o SQL Server, se o aplicativo solicitar criptografia e a instância do SQL Server estiver configurada para oferecer suporte à criptografia SSL, o Microsoft JDBC Driver para SQL Server iniciará o handshake SSL." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Compreendendo o suporte a SSL</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>Ao estabelecer conexão com o SQL Server, se o aplicativo solicitar criptografia e a instância do SQL Server estiver configurada para oferecer suporte à criptografia SSL, o Microsoft JDBC Driver para SQL Server iniciará o handshake SSL. O handshake permite que o servidor e o cliente negociem a criptografia e os algoritmos criptográficos a serem usados para proteger os dados. Após a conclusão do handshake SSL, o cliente e o servidor poderão enviar com segurança os dados criptografados. Durante o handshake SSL, o servidor envia seu certificado de chave pública ao cliente. O emissor de um certificado de chave pública é conhecido como uma Autoridade de Certificação (CA). O cliente é responsável por validar que a autoridade de certificação é de sua confiança.</p><p>Se o aplicativo não solicitar criptografia, o Microsoft JDBC Driver para SQL Server não forçará o SQL Server a oferecer suporte à criptografia SSL. Se a instância do SQL Server não estiver configurada para forçar a criptografia SSL, uma conexão será estabelecida sem criptografia. Se a instância do SQL Server estiver configurada para forçar a criptografia SSL, o driver habilitará a criptografia SSL automaticamente na execução em JVM (Máquina Virtual Java) configurada adequadamente; caso contrário, a conexão será encerrada e o driver gerará um erro.</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Verifique se o valor passado para <span sdata="langKeyword" value="serverName"><span class="keyword">serverName</span></span> coincide com o CN (Nome Comum) ou com o nome DNS na rede SAN (Subject Alternate Name) no certificado de servidor para que uma conexão SSL tenha êxito.</p></div><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Para obter mais informações sobre como configurar o SSL para SQL Server, consulte o tópico Criptografando Conexões com o SQL Server nos Manuais Online do SQL Server.</p></div></div><h1 class="heading">Comentários</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>Para permitir que os aplicativos usem a criptografia SSL, o Microsoft JDBC Driver para SQL Server apresenta as seguintes propriedades de conexão a partir da versão 1.2: <span class="label">encrypt</span>, <span class="label">trustServerCertificate</span>, <span class="label">trustStore</span>, <span class="label">trustStorePassword</span> e <span class="label">hostNameInCertificate</span>. Para obter mais informações, consulte <span sdata="link"><a href="f1b62700-f046-488d-bd6b-a5cd8fc345b7.htm">Definindo as propriedades de conexão</a></span>.</p><p>A tabela a seguir resume o comportamento da versão do Microsoft JDBC Driver para SQL Server em possíveis cenários de conexão SSL. Cada cenário usa um conjunto diferente de propriedades de conexão SSL. A tabela inclui: </p><ul><li><p><span sdata="langKeyword" value="blank"><span class="keyword">blank</span></span>: "A propriedade não existe na cadeia de conexão"</p></li><li><p><span sdata="langKeyword" value="value"><span class="keyword">value</span></span>: "A propriedade existe na cadeia de conexão e seu valor é válido"</p></li><li><p><span sdata="langKeyword" value="any"><span class="keyword">any</span></span>: "Não importa se a propriedade existe na cadeia de conexão ou se o seu valor é válido"</p></li></ul><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>O mesmo comportamento se aplica à autenticação de usuário do SQL Server e à autenticação integrada do Windows.</p></div><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>encrypt</p></th><th><p>trustServerCertificate</p></th><th><p>hostNameInCertificate</p></th><th><p>trustStore</p></th><th><p>trustStorePassword</p></th><th><p>Comportamento</p></th></tr><tr><td><p>false ou em branco</p></td><td><p>any</p></td><td><p>any</p></td><td><p>any</p></td><td><p>any</p></td><td><p>O Microsoft JDBC Driver para SQL Server não forçará o SQL Server a oferecer suporte à criptografia SSL. Se o servidor tiver um certificado autoassinado, o driver iniciará a troca de certificados SSL. O certificado SSL não será validado e apenas as credenciais (no pacote de logon) são criptografadas.</p><p>Se o servidor exigir que o cliente dê suporte à criptografia SSL, o driver iniciará a troca de certificados SSL. O certificado SSL não será validado, mas a comunicação inteira será criptografada.</p></td></tr><tr><td><p>true</p></td><td><p>true</p></td><td><p>any</p></td><td><p>any</p></td><td><p>any</p></td><td><p>O Microsoft JDBC Driver para SQL Server solicita o uso da criptografia SSL com o SQL Server. </p><p>Se o servidor exigir que o cliente dê suporte à criptografia SSL ou se o servidor der suporte à criptografia, o driver iniciará a troca de certificados SSL. Observe que, se a propriedade <span class="label">trustServerCertificate</span> for definida como "true", o driver não validará o certificado SSL.</p><p>Se o servidor não estiver configurado para dar suporte à criptografia, o driver irá gerar um erro e encerrará a conexão.</p></td></tr><tr><td><p>true</p></td><td><p>false ou em branco</p></td><td><p>em branco</p></td><td><p>em branco</p></td><td><p>em branco</p></td><td><p>O Microsoft JDBC Driver para SQL Server solicita o uso da criptografia SSL com o SQL Server. </p><p>Se o servidor exigir que o cliente dê suporte à criptografia SSL ou se o servidor der suporte à criptografia, o driver iniciará a troca de certificados SSL. </p><p>O driver usará a propriedade <span class="label">serverName</span> especificada na URL da conexão para validar o certificado SSL do servidor e contará com as regras de procura da fábrica do gerenciador de confiança para determinar qual repositório de certificados deve usar.</p><p>Se o servidor não estiver configurado para dar suporte à criptografia, o driver irá gerar um erro e encerrará a conexão.</p></td></tr><tr><td><p>true</p></td><td><p>false ou em branco</p></td><td><p>valor</p></td><td><p>em branco</p></td><td><p>em branco</p></td><td><p>O Microsoft JDBC Driver para SQL Server solicita o uso da criptografia SSL com o SQL Server. </p><p>Se o servidor exigir que o cliente dê suporte à criptografia SSL ou se o servidor der suporte à criptografia, o driver iniciará a troca de certificados SSL. </p><p>O driver validará o valor de assunto do certificado SSL usando o valor especificado para a propriedade <span class="label">hostNameInCertificate</span>.</p><p>Se o servidor não estiver configurado para dar suporte à criptografia, o driver irá gerar um erro e encerrará a conexão.</p></td></tr><tr><td><p>true</p></td><td><p>false ou em branco</p></td><td><p>em branco</p></td><td><p>valor</p></td><td><p>valor</p></td><td><p>O Microsoft JDBC Driver para SQL Server solicita o uso da criptografia SSL com o SQL Server. </p><p>Se o servidor exigir que o cliente dê suporte à criptografia SSL ou se o servidor der suporte à criptografia, o driver iniciará a troca de certificados SSL. </p><p>O driver usará o valor da propriedade <span class="label">trustStore</span> para localizar o arquivo trustStore do certificado e o valor da propriedade <span class="label">trustStorePassword</span> para verificar a integridade do arquivo trustStore.</p><p>Se o servidor não estiver configurado para dar suporte à criptografia, o driver irá gerar um erro e encerrará a conexão.</p></td></tr><tr><td><p>true</p></td><td><p>false ou em branco</p></td><td><p>em branco</p></td><td><p>em branco</p></td><td><p>valor</p></td><td><p>O Microsoft JDBC Driver para SQL Server solicita o uso da criptografia SSL com o SQL Server.</p><p>Se o servidor exigir que o cliente dê suporte à criptografia SSL ou se o servidor der suporte à criptografia, o driver iniciará a troca de certificados SSL. </p><p>O driver usará o valor da propriedade <span class="label">trustStorePassword</span> para verificar a integridade do arquivo trustStore padrão.</p><p>Se o servidor não estiver configurado para dar suporte à criptografia, o driver irá gerar um erro e encerrará a conexão.</p></td></tr><tr><td><p>true</p></td><td><p>false ou em branco</p></td><td><p>em branco</p></td><td><p>valor</p></td><td><p>em branco</p></td><td><p>O Microsoft JDBC Driver para SQL Server solicita o uso da criptografia SSL com o SQL Server. </p><p>Se o servidor exigir que o cliente dê suporte à criptografia SSL ou se o servidor der suporte à criptografia, o driver iniciará a troca de certificados SSL. </p><p>O driver usará o valor da propriedade <span class="label">trustStore</span> para procurar o local do arquivo trustStore.</p><p>Se o servidor não estiver configurado para dar suporte à criptografia, o driver irá gerar um erro e encerrará a conexão.</p></td></tr><tr><td><p>true</p></td><td><p>false ou em branco</p></td><td><p>valor</p></td><td><p>em branco</p></td><td><p>valor</p></td><td><p>O Microsoft JDBC Driver para SQL Server solicita o uso da criptografia SSL com o SQL Server. </p><p>Se o servidor exigir que o cliente dê suporte à criptografia SSL ou se o servidor der suporte à criptografia, o driver iniciará a troca de certificados SSL. </p><p>O driver usará o valor da propriedade <span class="label">trustStorePassword</span> para verificar a integridade do arquivo trustStore padrão. Além disso, o driver usará o valor da propriedade <span class="label">hostNameInCertificate</span> para validar o certificado SSL.</p><p>Se o servidor não estiver configurado para dar suporte à criptografia, o driver irá gerar um erro e encerrará a conexão.</p></td></tr><tr><td><p>true</p></td><td><p>false ou em branco</p></td><td><p>valor</p></td><td><p>valor</p></td><td><p>em branco</p></td><td><p>O Microsoft JDBC Driver para SQL Server solicita o uso da criptografia SSL com o SQL Server. </p><p>Se o servidor exigir que o cliente dê suporte à criptografia SSL ou se o servidor der suporte à criptografia, o driver iniciará a troca de certificados SSL. </p><p>O driver usará o valor da propriedade <span class="label">trustStore</span> para procurar o local do arquivo trustStore. Além disso, o driver usará o valor da propriedade <span class="label">hostNameInCertificate</span> para validar o certificado SSL.</p><p>Se o servidor não estiver configurado para dar suporte à criptografia, o driver irá gerar um erro e encerrará a conexão.</p></td></tr><tr><td><p>true</p></td><td><p>false ou em branco</p></td><td><p>valor</p></td><td><p>valor</p></td><td><p>valor</p></td><td><p>O Microsoft JDBC Driver para SQL Server solicita o uso da criptografia SSL com o SQL Server. </p><p>Se o servidor exigir que o cliente dê suporte à criptografia SSL ou se o servidor der suporte à criptografia, o driver iniciará a troca de certificados SSL. </p><p>O driver usará o valor da propriedade <span class="label">trustStore</span> para localizar o arquivo trustStore do certificado e o valor da propriedade <span class="label">trustStorePassword</span> para verificar a integridade do arquivo trustStore. Além disso, o driver usará o valor da propriedade <span class="label">hostNameInCertificate</span> para validar o certificado SSL.</p><p>Se o servidor não estiver configurado para dar suporte à criptografia, o driver irá gerar um erro e encerrará a conexão.</p></td></tr></table></div><p>Se a propriedade de criptografia for definida como <span sdata="langKeyword" value="true"><span class="keyword">true</span></span>, o Microsoft JDBC Driver para SQL Server usará o provedor de segurança JSSE padrão da JVM para negociar a criptografia SSL com o SQL Server. O provedor de segurança padrão pode não dar suporte a todos os recursos necessários para negociar a criptografia SSL com êxito. Por exemplo, o provedor de segurança padrão pode não dar suporte ao tamanho da chave pública RSA usada no certificado SSL do SQL Server. Nesse caso, o provedor de segurança padrão pode gerar um erro que fará com que o driver JDBC encerre a conexão. Para resolver esse problema, siga um destes procedimentos:</p><ul><li><p>Configure o SQL Server com um certificado de servidor que tenha uma chave pública RSA menor</p></li><li><p>Configure a JVM para usar um provedor de segurança JSSE diferente no arquivo de propriedades de segurança "&lt;java-home&gt;/lib/security/java.security"</p></li><li><p>Use uma JVM diferente</p></li></ul></div><h1 class="heading">Validando o certificado SSL do servidor</h1><div id="sectionSection1" class="section" name="collapseableSection" style=""><p>Durante o handshake SSL, o servidor envia seu certificado de chave pública ao cliente. O driver JDBC ou o cliente precisa validar que o certificado do servidor é emitido por uma autoridade de certificação de confiança do cliente. O driver requer que o certificado do servidor atenda às seguintes condições:</p><ul><li><p>O certificado foi emitido por uma autoridade de certificação confiável.</p></li><li><p>O certificado deve ser emitido para autenticação do servidor.</p></li><li><p>O certificado não expirou.</p></li><li><p>O CN (Nome Comum) no Assunto ou um nome DNS na rede SAN (Subject Alternate Name) do certificado coincide com o valor <span sdata="langKeyword" value="serverName"><span class="keyword">serverName</span></span> especificado na cadeia de conexão ou, caso especificado, com o valor de propriedade <span sdata="langKeyword" value="hostNameInCertificate"><span class="keyword">hostNameInCertificate</span></span>.</p></li><li><p>Um nome DNS pode incluir caracteres curinga. Mas o Microsoft JDBC Driver para SQL Server não oferece suporte à correspondência de caracteres curinga. Ou seja, abc.com não corresponderá a *.com, mas *.com corresponderá a *.com.</p></li></ul></div><span id="seeAlsoSpan"><h1 class="heading">Consulte também</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="8e566243-2f93-4b21-8065-3c8336649309.htm">Usando criptografia SSL</a></span></div><div class="seeAlsoStyle"><span sdata="link"><a href="90724ec6-a9cb-43ef-903e-793f89410bc0.htm">Protegendo aplicativos do JDBC Driver</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Envie <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dObrigado%20por%20seus%20comentários.%20As%20equipes%20de%20desenvolvimento%20usam%20seus%20comentários%20para%20melhorar%20a%20documentação.%20Enquanto%20estivermos%20examinando%20seus%20comentários%20,%20poderemos%20enviar%20um%20email%20solicitando%20mais%20esclarecimentos%20ou%20comentários%20sobre%20a%20solução%20encontrada%20.%20Não%20usaremos%20seu%20endereço%20de%20email%20para%20nenhum%20outro%20propósito%20e%20o%20excluiremos%20após%20concluirmos%20a%20análise.%0\APara%20obter%20informações%20sobre%20a%20política%20de%20privacidade%20da%20Microsoft,%20consulte%20http://privacy.microsoft.com/pt-br/default.aspx.%0\A%0\d','Comentários%20do%20cliente.');">comentários</a> sobre este tópico à Microsoft.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft. Todos os direitos reservados.</a></p></span></div></div></body></html>
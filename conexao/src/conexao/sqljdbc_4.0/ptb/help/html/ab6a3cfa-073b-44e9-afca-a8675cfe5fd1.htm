<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Usando vários conjuntos de resultados</title><meta name="Language" content="pt-br" /><meta name="System.Keywords" content="vários conjuntos de resultados" /><meta name="Microsoft.Help.Id" content="ab6a3cfa-073b-44e9-afca-a8675cfe5fd1" /><meta name="Description" content="Ao trabalhar com o SQL embutido ou procedimentos armazenados do SQL Server que retornam mais de um conjunto de resultados, o Microsoft JDBC Driver para SQL Server fornece o método getResultSet na classe SQLServerStatement para recuperar cada conjunto de da" /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Usando vários conjuntos de resultados</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>Ao trabalhar com o SQL embutido ou procedimentos armazenados do SQL Server que retornam mais de um conjunto de resultados, o Microsoft JDBC Driver para SQL Server fornece o método <a href="929a14e2-8e98-4c32-89aa-86733c717ec1.htm">getResultSet</a> na classe <a href="ec24963c-8b51-4838-91e9-1fbfa2347451.htm">SQLServerStatement</a> para recuperar cada conjunto de dados retornado. Além disso, ao executar uma instrução que retorna mais de um conjunto de resultados, você pode usar o método <a href="e1367f39-23d7-4e26-b160-6d988d7e6988.htm">execute</a> da classe <b>SQLServerStatement</b>, porque retornará um valor <span sdata="langKeyword" value="boolean"><span class="keyword">boolean</span></span> que indica se o valor retornado é um conjunto de resultados ou uma contagem de atualização. </p><p>Se o método <b>execute</b> retornar <span sdata="langKeyword" value="true"><span class="keyword">true</span></span>, isso significa que a instrução que foi executada retornou um ou mais conjuntos de resultados. Você pode acessar o primeiro conjunto de resultados chamando o método <b>getResultSet</b>. Para determinar se mais conjuntos de resultados estão disponíveis, você pode chamar o método <a href="6b18510a-4d6d-4eeb-a9d0-32e920eb0048.htm">getMoreResults</a> que retornará um valor <span sdata="langKeyword" value="boolean"><span class="keyword">boolean</span></span> de <span sdata="langKeyword" value="true"><span class="keyword">true</span></span> se mais conjuntos de resultados estiverem disponíveis. Se mais conjuntos de resultados estiverem disponíveis, você pode chamar o método <b>getResultSet</b> novamente para acessá-los, continuando o processo até que todos os conjuntos de resultados tenham sido processados. Se o método <b>getMoreResults</b> retornar <span sdata="langKeyword" value="false"><span class="keyword">false</span></span>, não haverá nenhum mais conjuntos de resultados para processar.</p><p>Se o método <b>execute</b> retornar <span sdata="langKeyword" value="false"><span class="keyword">false</span></span>, a instrução que foi executada retornou um valor de contagem de atualização que você pode recuperar chamando o método <a href="e9570228-4500-44b6-b2f1-84ac050b5112.htm">getUpdateCount</a>.</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Para obter mais informações sobre contagens de atualização, consulte <span sdata="link"><a href="64cf4877-5995-4bfc-8865-b7618a5c8d01.htm">Usando um procedimento armazenado com uma contagem de atualização</a></span>.</p></div><p>No exemplo a seguir, uma conexão aberta com o banco de dados de exemplo AdventureWorks do SQL Server 2005 é passada para a função, e uma instrução SQL é construída para, quando for executada, retornar dois conjuntos de resultados:</p><div name="snippetGroup"><div class="sampleCode"><span codeLanguage="Java"><pre>public static void executeStatement(Connection con) {
   try {
      String SQL = "SELECT TOP 10 * FROM Person.Contact; " +
                   "SELECT TOP 20 * FROM Person.Contact";
      Statement stmt = con.createStatement();
      boolean results = stmt.execute(SQL);
      int rsCount = 0;

      //Loop through the available result sets.
     do {
        if(results) {
           ResultSet rs = stmt.getResultSet();
           rsCount++;

           //Show data from the result set.
           System.out.println("RESULT SET #" + rsCount);
           while (rs.next()) {
              System.out.println(rs.getString("LastName") + ", " + rs.getString("FirstName"));
           }
           rs.close();
        }
        System.out.println();
        results = stmt.getMoreResults();
        } while(results);
      stmt.close();
      }
   catch (Exception e) {
      e.printStackTrace();
   }
}

</pre></span></div></div><p>Neste caso, o número de conjuntos de resultados retornado é conhecido para ser dois. Porém, o código é escrito de forma que, se um número desconhecido de conjuntos de resultados fosse retornado, como ao chamar um procedimento armazenado, todos eles seriam processados. Para ver um exemplo de chamada de procedimento armazenado que retorna vários conjuntos de resultados junto com valores de atualização, consulte <span sdata="link"><a href="6b807a45-a8b5-4b1c-8b7b-d8175c710ce0.htm">Tratando instruções complexas</a></span>.</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Quando você fizer a chamada para o método <b>getMoreResults</b> da classe <b>SQLServerStatement</b> classe, o conjunto de resultados previamente retornado será fechado implicitamente.</p></div></div><span id="seeAlsoSpan"><h1 class="heading">Consulte também</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="7f8f3e8f-841e-4449-9154-b5366870121f.htm">Usando instruções com o JDBC Driver</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Envie <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dObrigado%20por%20seus%20comentários.%20As%20equipes%20de%20desenvolvimento%20usam%20seus%20comentários%20para%20melhorar%20a%20documentação.%20Enquanto%20estivermos%20examinando%20seus%20comentários%20,%20poderemos%20enviar%20um%20email%20solicitando%20mais%20esclarecimentos%20ou%20comentários%20sobre%20a%20solução%20encontrada%20.%20Não%20usaremos%20seu%20endereço%20de%20email%20para%20nenhum%20outro%20propósito%20e%20o%20excluiremos%20após%20concluirmos%20a%20análise.%0\APara%20obter%20informações%20sobre%20a%20política%20de%20privacidade%20da%20Microsoft,%20consulte%20http://privacy.microsoft.com/pt-br/default.aspx.%0\A%0\d','Comentários%20do%20cliente.');">comentários</a> sobre este tópico à Microsoft.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft. Todos os direitos reservados.</a></p></span></div></div></body></html>
<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Conectando-se com criptografia SSL</title><meta name="Language" content="pt-br" /><meta name="System.Keywords" content="criptografia" /><meta name="System.Keywords" content="SSL" /><meta name="Microsoft.Help.Id" content="ec91fa8a-ab7e-4c1e-a05a-d7951ddf33b1" /><meta name="Description" content="Os exemplos neste tópico descrevem como usar propriedades de cadeia de conexão que permitem aos aplicativos usar criptografia de Protocolo SSL (Secure Sockets Layer) em um aplicativo Java." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Conectando-se com criptografia SSL</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>Os exemplos neste tópico descrevem como usar propriedades de cadeia de conexão que permitem aos aplicativos usar criptografia de Protocolo SSL (Secure Sockets Layer) em um aplicativo Java. Para obter mais informações sobre essas novas propriedades da cadeia de conexão, como <span class="label">encrypt</span>, <span class="label">trustServerCertificate</span>, <span class="label">trustStore</span>, <span class="label">trustStorePassword</span> e <span class="label">hostNameInCertificate</span>, consulte <span sdata="link"><a href="f1b62700-f046-488d-bd6b-a5cd8fc345b7.htm">Definindo as propriedades de conexão</a></span>.</p><p>Quando a propriedade <span class="label">encrypt</span> estiver definida como <span sdata="langKeyword" value="true"><span class="keyword">true</span></span> e a propriedade <span class="label">trustServerCertificate</span> estiver definida como <span sdata="langKeyword" value="true"><span class="keyword">true</span></span>, o Microsoft JDBC Driver para SQL Server não validará o certificado SSL do SQL Server. Isso costuma ser obrigatório para permitir conexões em ambientes de teste, como naqueles em que a instância do SQL Server tem apenas um certificado autoassinado.</p><p>O exemplo de código a seguir demonstra como definir a propriedade <span class="label">trustServerCertificate</span> em uma cadeia de conexão:</p><div class="sampleCode"><span codeLanguage="other"><pre>String connectionUrl = 
    "jdbc:sqlserver://localhost:1433;" +
     "databaseName=AdventureWorks;integratedSecurity=true;" +
     "encrypt=true;trustServerCertificate=true";</pre></span></div><p>Quando a propriedade <span class="label">encrypt</span> estiver definida como <span sdata="langKeyword" value="true"><span class="keyword">true</span></span> e a propriedade <span class="label">trustServerCertificate</span> estiver definida como <span sdata="langKeyword" value="false"><span class="keyword">false</span></span>, o Microsoft JDBC Driver para SQL Server validará o certificado SSL do SQL Server. A validação do certificado do servidor é parte do handshake SSL e garante que o servidor é o servidor correto para a conexão. Para validar o certificado do servidor, o material confiável deve ser fornecido no momento da conexão usando-se as propriedades de conexão <span class="label">trustStore</span> e <span class="label">trustStorePassword</span> explicitamente ou o armazenamento de confiança padrão da JVM (Máquina Virtual Java) subjacente. </p><p>A propriedade <span class="label">trustStore</span> especifica o caminho (inclusive o nome de arquivo) para o arquivo trustStore do certificado, que contém a lista de certificados na qual o cliente confia. A propriedade <span class="label">trustStorePassword</span> especifica a senha usada para verificar a integridade dos dados de trustStore. Para obter mais informações sobre como usar o trustStore padrão da JVM, consulte <span sdata="link"><a href="ae34cd1f-3569-4759-80c7-7c9b33b3e9eb.htm">Configurando o cliente para criptografia SSL</a></span>.</p><p>O exemplo de código a seguir demonstra como definir as propriedades <span class="label">trustStore</span> and <span class="label">trustStorePassword</span> em uma cadeia de conexão: </p><div class="sampleCode"><span codeLanguage="other"><pre>String connectionUrl = 
    "jdbc:sqlserver://localhost:1433;" +
     "databaseName=AdventureWorks;integratedSecurity=true;" +
     "encrypt=true; trustServerCertificate=false;" +
     "trustStore=storeName;trustStorePassword=storePassword";</pre></span></div><p>O JDBC Driver fornece uma propriedade adicional, <span class="label">hostNameInCertificate</span>, que especifica o nome de host do servidor. O valor dessa propriedade deve corresponder à propriedade subject do certificado. </p><p>O exemplo de código a seguir demonstra como usar a propriedade <span class="label">hostNameInCertificate</span> em uma cadeia de conexão:</p><div class="sampleCode"><span codeLanguage="other"><pre>String connectionUrl = 
    "jdbc:sqlserver://localhost:1433;" +
     "databaseName=AdventureWorks;integratedSecurity=true;" +
     "encrypt=true; trustServerCertificate=false;" +
     "trustStore=storeName;trustStorePassword=storePassword" +
     "hostNameInCertificate=hostName";</pre></span></div><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Também é possível definir o valor das propriedades da conexão usando os métodos <span sdata="langKeyword" value="setter"><span class="keyword">setter</span></span> apropriados fornecidos pela classe <a href="097434fd-2b74-411c-a5ed-eba04481dde5.htm">SQLServerDataSource</a>.</p></div><p>Se a propriedade <span class="label">encrypt</span> estiver definida como <span sdata="langKeyword" value="true"><span class="keyword">true</span></span>, a propriedade <span class="label">trustServerCertificate</span> estiver definida como <span sdata="langKeyword" value="false"><span class="keyword">false</span></span> e o nome do servidor na cadeia de conexão não coincidir com o nome do servidor no certificado SSL do SQL Server, o seguinte erro será emitido: o driver não conseguiu estabelecer uma conexão segura com o SQL Server usando a criptografia de protocolo SSL. Erro: "java.security.cert.CertificateException: falha ao validar o nome do servidor em um certificado durante a inicialização do protocolo SSL."</p></div><span id="seeAlsoSpan"><h1 class="heading">Consulte também</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="8e566243-2f93-4b21-8065-3c8336649309.htm">Usando criptografia SSL</a></span></div><div class="seeAlsoStyle"><span sdata="link"><a href="90724ec6-a9cb-43ef-903e-793f89410bc0.htm">Protegendo aplicativos do JDBC Driver</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Envie <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dObrigado%20por%20seus%20comentários.%20As%20equipes%20de%20desenvolvimento%20usam%20seus%20comentários%20para%20melhorar%20a%20documentação.%20Enquanto%20estivermos%20examinando%20seus%20comentários%20,%20poderemos%20enviar%20um%20email%20solicitando%20mais%20esclarecimentos%20ou%20comentários%20sobre%20a%20solução%20encontrada%20.%20Não%20usaremos%20seu%20endereço%20de%20email%20para%20nenhum%20outro%20propósito%20e%20o%20excluiremos%20após%20concluirmos%20a%20análise.%0\APara%20obter%20informações%20sobre%20a%20política%20de%20privacidade%20da%20Microsoft,%20consulte%20http://privacy.microsoft.com/pt-br/default.aspx.%0\A%0\d','Comentários%20do%20cliente.');">comentários</a> sobre este tópico à Microsoft.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft. Todos os direitos reservados.</a></p></span></div></div></body></html>
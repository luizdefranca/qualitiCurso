<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Compreendendo os tipos de cursor</title><meta name="Language" content="pt-br" /><meta name="System.Keywords" content="tipos de cursor" /><meta name="Microsoft.Help.Id" content="4f4d3db7-4f76-450d-ab63-141237a4f034" /><meta name="Description" content="As operações em um banco de dados relacional agem sobre um conjunto completo de linhas. O conjunto de linhas retornado por uma instrução SELECT consiste em todas as linhas que satisfazem as condições na cláusula WHERE da instrução." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Compreendendo os tipos de cursor</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>As operações em um banco de dados relacional agem sobre um conjunto completo de linhas. O conjunto de linhas retornado por uma instrução SELECT consiste em todas as linhas que satisfazem as condições na cláusula WHERE da instrução. Esse conjunto completo de linhas retornado pela instrução é conhecido como conjunto de resultados. Nem sempre os aplicativos podem trabalhar efetivamente com o conjunto de resultados inteiro como uma unidade. Esses aplicativos precisam de um mecanismo para trabalhar com uma linha ou um bloco pequeno de linhas de cada vez. Os cursores são uma extensão dos conjuntos de resultados que proveem esse mecanismo. </p><p>Os cursores estendem o processamento do conjunto de resultados fazendo o seguinte:</p><ul><li><p>Permitindo o posicionamento em linhas específicas do conjunto de resultados.</p></li><li><p>Recuperando uma linha ou um bloco de linhas da posição atual no conjunto de resultados.</p></li><li><p>Oferecendo suporte a modificações de dados na linha da posição atual no conjunto de resultados.</p></li><li><p>Oferecendo suporte a diferentes níveis de visibilidade para as alterações feitas por outros usuários nos dados do banco de dados que são apresentados no conjunto de resultados.</p></li></ul><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Para obter uma descrição completa dos tipos de cursor do SQL Server, consulte o tópico "Tipos de cursor (Mecanismo de Banco de Dados)" nos Manuais Online do SQL Server.</p></div><p>A especificação do JDBC provê suporte para cursores somente encaminhamento e roláveis que são sensíveis ou insensíveis a alterações feitas por outros trabalhos e podem ser somente leitura ou atualizáveis. Essa funcionalidade é fornecida pela classe <a href="eaffcff1-286c-459f-83da-3150778480c9.htm">SQLServerResultSet</a> do Microsoft JDBC Driver para SQL Server.</p></div><h1 class="heading">Comentários</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>O driver JDBC oferece suporte aos seguintes tipos de cursores:</p><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>Tipo de conjunto de </p><p>resultados (cursor)</p></th><th><p>Tipo de cursor do SQL Server</p></th><th><p>Características</p></th><th><p>Método</p><p>de seleção</p></th><th><p>Buffer</p><p>de resposta</p></th><th><p>Descrição</p></th></tr><tr><td><p>TYPE_FORWARD_ONLY (CONCUR_READ_ONLY)</p></td><td><p>N/D</p></td><td><p>Somente encaminhamento, somente leitura</p></td><td><p>direct</p></td><td><p>completo</p></td><td><p>O aplicativo tem que fazer uma única passagem (para a frente) pelo conjunto de resultados. Esse é o comportamento padrão, que é o mesmo de um cursor TYPE_SS_DIRECT_FORWARD_ONLY. O driver lê o conjunto de resultados inteiro do servidor em uma memória durante o tempo de execução da instrução. </p></td></tr><tr><td><p>TYPE_FORWARD_ONLY (CONCUR_READ_ONLY)</p></td><td><p>N/D</p></td><td><p>Somente encaminhamento, somente leitura</p></td><td><p>direct</p></td><td><p>adaptive</p></td><td><p>O aplicativo tem que fazer uma única passagem (para a frente) pelo conjunto de resultados. O comportamento é igual ao de um cursor TYPE_SS_DIRECT_FORWARD_ONLY. O driver lê as linhas do servidor à medida que o aplicativo as solicita e assim minimiza o uso de memória do lado do cliente.</p></td></tr><tr><td><p>TYPE_FORWARD_ONLY (CONCUR_READ_ONLY)</p></td><td><p>Avançar</p></td><td><p>Somente encaminhamento, somente leitura</p></td><td><p>cursor</p></td><td><p>N/D</p></td><td><p>O aplicativo tem que fazer uma única passagem (para a frente) pelo conjunto de resultados usando um cursor de servidor. O comportamento é igual ao de um cursor TYPE_SS_SERVER_CURSOR_FORWARD_ONLY.</p><p>As linhas são recuperadas do servidor em blocos especificados pelo tamanho da busca.</p></td></tr><tr><td><p>TYPE_FORWARD_ONLY (CONCUR_UPDATABLE)</p></td><td><p>Dinâmico (somente encaminhamento)</p></td><td><p>Somente encaminhamento, atualizável</p></td><td><p>N/D</p></td><td><p>N/D</p></td><td><p>O aplicativo tem que fazer uma única passagem (para a frente) pelo conjunto de resultados para atualizar uma ou mais linhas. </p><p>As linhas são recuperadas do servidor em blocos especificados pelo tamanho da busca.</p><p>Por padrão, o tamanho da busca é fixado quando o aplicativo chama o método <a href="233bf4f8-4758-42d0-a80b-33e34fa78027.htm">setFetchSize</a> do objeto <a href="eaffcff1-286c-459f-83da-3150778480c9.htm">SQLServerResultSet</a>. </p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>O JDBC Driver fornece um recurso de buffer adaptável que permite recuperar resultados da execução de instruções do SQL Server à medida que o aplicativo precisar deles, e não tudo de uma vez. Por exemplo, se o aplicativo precisar recuperar um volume de dados grande demais para caber inteiramente na memória do aplicativo, o buffer adaptável permitirá que o aplicativo cliente recupere esse valor como um fluxo. </p><p>O comportamento padrão do driver é "<span sdata="langKeyword" value="adaptive"><span class="keyword">adaptive</span></span>". No entanto, a fim de obter o buffer adaptável para os conjuntos de resultados atualizáveis de somente encaminhamento, o aplicativo precisa chamar explicitamente o método <a href="9f489835-6cda-4c8c-b139-079639a169cf.htm">setResponseBuffering</a> do objeto <a href="ec24963c-8b51-4838-91e9-1fbfa2347451.htm">SQLServerStatement</a> fornecendo um valor de <span sdata="langKeyword" value="String"><span class="keyword">String</span></span> "<span sdata="langKeyword" value="adaptive&quot;"><span class="keyword">adaptive"</span></span>. Para obter um código de exemplo, consulte <span sdata="link"><a href="76ecc05f-a77d-40a2-bab9-91a7fcf17347.htm">Atualizando exemplo de dados grande</a></span>.</p></div></td></tr><tr><td><p>TYPE_SCROLL_INSENSITIVE</p></td><td><p>Estático</p></td><td><p>Rolável, não atualizável.</p><p>Atualizações, inserções e exclusões de linhas externas não são visíveis.</p></td><td><p>N/D</p></td><td><p>N/D</p></td><td><p>O aplicativo requer um instantâneo do banco de dados. O conjunto de resultados não é atualizável. Só há suporte para CONCUR_READ_ONLY.  Todos os outros tipos de simultaneidade causarão uma exceção quando usados com este tipo de cursor.</p><p>As linhas são recuperadas do servidor em blocos especificados pelo tamanho da busca.</p></td></tr><tr><td><p>TYPE_SCROLL_SENSITIVE</p><p>(CONCUR_READ_ONLY)</p></td><td><p>Keyset</p></td><td><p>Rolável, somente leitura. As atualizações de linhas externas são visíveis, e as exclusões aparecem como dados ausentes.</p><p>As inserções de linhas externas não são visíveis. </p></td><td><p>N/D</p></td><td><p>N/D</p></td><td><p>O aplicativo tem que ver dados alterados somente para linhas existentes.</p><p>As linhas são recuperadas do servidor em blocos especificados pelo tamanho da busca.</p></td></tr><tr><td><p>TYPE_SCROLL_SENSITIVE</p><p>(CONCUR_UPDATABLE, CONCUR_SS_SCROLL_LOCKS, CONCUR_SS_OPTIMISTIC_CC, CONCUR_SS_OPTIMISTIC_CCVAL)</p></td><td><p>Keyset</p></td><td><p>Rolável, atualizável. </p><p>As atualizações de linhas externas e internas são visíveis, e as exclusões aparecem como dados ausentes; as inserções não são visíveis.</p></td><td><p>N/D</p></td><td><p>N/D</p></td><td><p>O aplicativo pode alterar dados nas linhas existentes usando o objeto <b>ResultSet</b>. O aplicativo também deve ser capaz de ver as alterações em linhas feitas por outros de fora do objeto <b>ResultSet</b>.</p><p>As linhas são recuperadas do servidor em blocos especificados pelo tamanho da busca.</p></td></tr><tr><td><p>TYPE_SS_DIRECT_FORWARD_ONLY</p></td><td><p>N/D</p></td><td><p>Somente encaminhamento, somente leitura</p></td><td><p>N/D</p></td><td><p>completo ou adaptável</p></td><td><p>Valor inteiro = 2003. Fornece um cursor somente leitura do lado do cliente que é totalmente armazenado em buffer. Nenhum cursor de servidor é criado.</p><p>Só há suporte para o tipo de simultaneidade CONCUR_READ_ONLY. Todos os outros tipos de simultaneidade causarão uma exceção quando usados com este tipo de cursor.</p></td></tr><tr><td><p>TYPE_SS_SERVER_CURSOR_FORWARD_ONLY</p></td><td><p>Avançar</p></td><td><p>Somente encaminhamento</p></td><td><p>N/D</p></td><td><p>N/D</p></td><td><p>Valor inteiro = 2004. Rápido, acessa todos os dados usando um cursor de servidor. É atualizável quando usado com o tipo de simultaneidade CONCUR_UPDATABLE.</p><p>As linhas são recuperadas do servidor em blocos especificados pelo tamanho da busca.</p><p>A fim de obter o buffer adaptável para este caso, o aplicativo tem que chamar explicitamente o método <a href="9f489835-6cda-4c8c-b139-079639a169cf.htm">setResponseBuffering</a> do objeto <a href="ec24963c-8b51-4838-91e9-1fbfa2347451.htm">SQLServerStatement</a> fornecendo o valor de <span sdata="langKeyword" value="String"><span class="keyword">String</span></span> "<span sdata="langKeyword" value="adaptive&quot;"><span class="keyword">adaptive"</span></span>. Para obter um código de exemplo, consulte <span sdata="link"><a href="76ecc05f-a77d-40a2-bab9-91a7fcf17347.htm">Atualizando exemplo de dados grande</a></span>.</p></td></tr><tr><td><p>TYPE_SS_SCROLL_STATIC</p></td><td><p>Estático</p></td><td><p>As atualizações de outros usuários não são refletidas.</p></td><td><p>N/D</p></td><td><p>N/D</p></td><td><p>Valor inteiro = 1004. O aplicativo requer um instantâneo do banco de dados. Este é o sinônimo específico do SQL Server para o TYPE_SCROLL_INSENSITIVE do JDBC e tem o mesmo comportamento de configuração de simultaneidade.</p><p>As linhas são recuperadas do servidor em blocos especificados pelo tamanho da busca.</p></td></tr><tr><td><p>TYPE_SS_SCROLL_KEYSET</p><p>(CONCUR_READ_ONLY)</p></td><td><p>Keyset</p></td><td><p>Rolável, somente leitura. As atualizações de linhas externas são visíveis, e as exclusões aparecem como dados ausentes.</p><p>As inserções de linhas externas não são visíveis.</p></td><td><p>N/D</p></td><td><p>N/D</p></td><td><p>Valor inteiro = 1005. O aplicativo tem que ver dados alterados somente para linhas existentes. Este é o sinônimo específico do SQL Server para o TYPE_SCROLL_SENSITIVE do JDBC e tem o mesmo comportamento de configuração de simultaneidade.</p><p>As linhas são recuperadas do servidor em blocos especificados pelo tamanho da busca.</p></td></tr><tr><td><p>TYPE_SS_SCROLL_KEYSET</p><p>(CONCUR_UPDATABLE, CONCUR_SS_SCROLL_LOCKS, CONCUR_SS_OPTIMISTIC_CC, CONCUR_SS_OPTIMISTIC_CCVAL)</p></td><td><p>Keyset</p></td><td><p>Rolável, atualizável. </p><p>As atualizações de linhas externas e internas são visíveis, e as exclusões aparecem como dados ausentes; as inserções não são visíveis.</p></td><td><p>N/D</p></td><td><p>N/D</p></td><td><p>Valor inteiro = 1005. O aplicativo tem que alterar dados ou ver dados alterados para linhas existentes. Este é o sinônimo específico do SQL Server para o TYPE_SCROLL_SENSITIVE do JDBC e tem o mesmo comportamento de configuração de simultaneidade.</p><p>As linhas são recuperadas do servidor em blocos especificados pelo tamanho da busca.</p></td></tr><tr><td><p>TYPE_SS_SCROLL_DYNAMIC</p><p>(CONCUR_READ_ONLY)</p></td><td><p>Dinâmico</p></td><td><p>Rolável, somente leitura. </p><p>As atualizações e as inserções de linhas externas são visíveis, e as exclusões aparecem como dados ausentes transitórios no buffer de busca atual. </p></td><td><p>N/D</p></td><td><p>N/D</p></td><td><p>Valor inteiro = 1006. O aplicativo deve ver dados alterados para linhas existentes, além de ver linhas inseridas e excluídas durante o tempo de vida do cursor.</p><p>As linhas são recuperadas do servidor em blocos especificados pelo tamanho da busca.</p></td></tr><tr><td><p>TYPE_SS_SCROLL_DYNAMIC</p><p>(CONCUR_UPDATABLE, CONCUR_SS_SCROLL_LOCKS, CONCUR_SS_OPTIMISTIC_CC, CONCUR_SS_OPTIMISTIC_CCVAL)</p></td><td><p>Dinâmico</p></td><td><p>Rolável, atualizável. </p><p>As atualizações e as inserções de linhas externas e internas são visíveis, e as exclusões aparecem como dados ausentes transitórios no buffer de busca atual.</p></td><td><p>N/D</p></td><td><p>N/D</p></td><td><p>Valor inteiro = 1006. O aplicativo pode alterar dados para linhas existentes, ou inserir ou excluir linhas usando o objeto <b>ResultSet</b>. O aplicativo também deve ser capaz de ver as alterações, inserções e exclusões feitas por outros de fora do objeto <b>ResultSet</b>.</p><p>As linhas são recuperadas do servidor em blocos especificados pelo tamanho da busca.</p></td></tr></table></div></div><h1 class="heading">Posicionamento dos cursores</h1><div id="sectionSection1" class="section" name="collapseableSection" style=""><p>Os cursores TYPE_FORWARD_ONLY, TYPE_SS_DIRECT_FORWARD_ONLY e TYPE_SS_SERVER_CURSOR_FORWARD_ONLY oferecem suporte apenas ao método de posicionamento <a href="60248447-6908-4036-a779-a501453cd553.htm">next</a>.</p><p>O cursor TYPE_SS_SCROLL_DYNAMIC não oferece suporte aos métodos <a href="638e8148-8ca0-4e1f-9ec2-04a11bc9809b.htm">absolute</a> e <a href="a266e3bc-05c2-44e2-9346-125ae6780216.htm">getRow</a>. O método <b>absolute</b> pode ser aproximado por uma combinação de chamadas para os métodos <a href="67ed9447-7b10-4c87-98e7-f4c2e2470b3a.htm">first</a> e <a href="2bcdbb69-95fd-4ae8-8488-1a75a91fe2e0.htm">relative</a> para cursores dinâmicos.</p><p>O método <b>getRow</b> só tem suporte dos cursores TYPE_FORWARD_ONLY, TYPE_SS_DIRECT_FORWARD_ONLY, TYPE_SS_SERVER_CURSOR_FORWARD_ONLY, TYPE_SS_SCROLL_KEYSET e TYPE_SS_SCROLL_STATIC. O método <b>getRow</b> com todos os tipos de cursor somente encaminhamento retorna o número de linhas lidas até o momento através do cursor.</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Quando um aplicativo faz uma chamada de posicionamento de cursor sem suporte, ou uma chamada sem suporte para o método <b>getRow</b>, uma exceção é lançada com a mensagem "A operação solicitada não tem suporte com esse tipo de cursor."</p></div><p>Só o cursor TYPE_SS_SCROLL_KEYSET e o TYPE_SCROLL_SENSITIVE equivalente expõem linhas excluídas. Se o cursor for posicionado em uma linha excluída, os valores de coluna não estarão disponíveis e o método <a href="9c6db315-e614-4604-b020-41af6a214cc1.htm">rowDeleted</a> retornará "true". As chamadas para os métodos <b>get&lt;Type&gt;</b> lançam uma exceção com a mensagem "Não é possível obter um valor de uma linha excluída." As linhas excluídas não podem ser atualizadas. Se você tentar chamar um método <b>update&lt;Type&gt;</b> em uma linha excluída, uma exceção será lançada com a mensagem "Uma linha excluída não pode ser atualizada." O cursor TYPE_SS_SCROLL_DYNAMIC tem o mesmo comportamento até ser movido para fora do buffer de busca atual.</p><p>Os cursores dinâmicos e de avançar expõem as linhas excluídas de modo semelhante, mas só enquanto permanecem acessíveis no buffer de busca. Para os cursores de avançar, isso é bastante direto. Para os cursores dinâmicos, é mais complexo quando o tamanho da busca é maior que 1. Um aplicativo pode mover o cursor para a frente e para trás dentro da janela definida pelo buffer de busca, mas a linha excluída desaparecerá quando a ação sair do buffer de busca original no qual ocorreu a atualização. Se um aplicativo não desejar ver as linhas excluídas transitórias usando cursores dinâmicos, deverá ser usado um relativo de busca (0).</p><p>Se os valores-chave de uma linha de cursor TYPE_SS_SCROLL_KEYSET ou TYPE_SCROLL_SENSITIVE forem atualizados com o cursor, a linha reterá sua posição original no conjunto de resultados, quer a linha atualizada atenda ou não aos critérios de seleção do cursor. Se a linha foi atualizada fora do cursor, uma linha excluída aparecerá na posição original da linha, mas a linha só aparecerá no cursor se outra linha com os novos valores-chave estava presente no cursor, mas foi excluída subsequentemente. </p><p>Para cursores dinâmicos, as linhas atualizadas reterão sua posição dentro do buffer de busca até que a ação saia da janela definida pelo buffer de busca. Linhas atualizadas podem reaparecer subsequentemente em posições diferentes dentro do conjunto de resultados ou podem desaparecer completamente. Os aplicativos que precisam evitar inconsistências transitórias no conjunto de resultados devem usar um tamanho de busca igual a 1 (o padrão é 8 linhas com simultaneidade de CONCUR_SS_SCROLL_LOCKS e 128 linhas com outras simultaneidades).</p></div><h1 class="heading">Conversão de cursores</h1><div id="sectionSection2" class="section" name="collapseableSection" style=""><p>Às vezes, o SQL Server pode escolher implementar um tipo de cursor diferente do que foi solicitado, circunstância conhecida como conversão implícita de cursor (ou degradação de cursor). Para obter mais informações sobre a conversão de cursor implícita, consulte o tópico "Usando conversões de cursor implícitas" nos Manuais Online do SQL Server.</p><p>Com o SQL Server 2000, quando você atualiza os dados pelo conjunto de resultados <b>ResultSet.TYPE_SCROLL_SENSITIVE</b> e <b>ResultSet.CONCUR_UPDATABLE</b>, uma exceção é lançada com a mensagem "O cursor é READ ONLY." Essa exceção ocorre porque o SQL Server 2000 fez uma conversão implícita de cursor para esse conjunto de resultados e não retornou o cursor atualizável que foi solicitado.</p><p>Para solucionar esse problema, você pode usar uma das duas soluções a seguir:</p><ul><li><p>Verifique se a tabela subjacente tem uma chave primária</p></li><li><p>Use <a href="d87afd89-3e75-402c-b844-1b434eb258df.htm">SQLServerResultSet.TYPE_SS_SCROLL_DYNAMIC</a> em vez de <b>ResultSet.TYPE_SCROLL_SENSITIVE</b> enquanto cria uma instrução.</p></li></ul></div><h1 class="heading">Atualização de cursores</h1><div id="sectionSection3" class="section" name="collapseableSection" style=""><p>Há suporte para atualizações in-loco de cursores nos casos em que a simultaneidade e o tipo do cursor oferecem suporte a atualizações. Se o cursor não estiver posicionado em uma linha atualizável no conjunto de resultados (nenhuma chamada de método <b>get&lt;Type&gt;</b> foi bem-sucedida), uma chamada para um método <b>update&lt;Type&gt;</b> lançará uma exceção com a mensagem "O conjunto de resultados não tem linha atual." A especificação do JDBC declara que uma exceção ocorre quando um método de atualização é chamado para uma coluna de um cursor que é CONCUR_READ_ONLY. Em situações onde a linha não é atualizável, por exemplo, por causa de um conflito de simultaneidade otimista como uma atualização ou exclusão concorrente, a exceção poderá não ocorrer até que o método <a href="363d1008-1396-4fc0-8e27-c9ba2499e7f1.htm">insertRow</a>, <a href="cfced0ca-a281-40dc-8d2f-370d5f0bf12b.htm">updateRow</a> ou <a href="aa04a644-c7c2-4738-8b6e-7fea566d2c16.htm">deleteRow</a> seja chamado.</p><p>Depois de uma chamada para <b>update&lt;Type&gt;</b>, a coluna afetada não poderá ser acessada por <b>get&lt;Type&gt;</b> até que <b>updateRow</b> ou <a href="2ecacca4-f7bc-4f5d-886a-da7747fdccae.htm">cancelRowUpdates</a> seja chamado. Isso evita problemas em que uma coluna é atualizada usando um tipo diferente do tipo retornado pelo servidor, e chamadas de getter subsequentes poderiam invocar conversões de tipo do lado do cliente com resultados inexatos. Chamadas para <b>get&lt;Type&gt;</b> lançarão uma exceção com a mensagem "Não é possível acessar as colunas atualizadas até que updateRow() ou cancelRowUpdates() seja chamado."</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Se o método <b>updateRow</b> for chamado quando nenhuma coluna tiver sido atualizada, o driver JDBC lançará uma exceção com a mensagem "updateRow() chamado quando nenhuma coluna foi atualizada."</p></div><p>Depois que <a href="f3c54bfe-d5b7-4f6e-ae6c-3e8954e5b1c9.htm">moveToInsertRow</a> for chamado, uma exceção será lançada se qualquer método que não seja <b>get&lt;Type&gt;</b>, <b>update&lt;Type&gt;</b>, <b>insertRow,</b> e os métodos de posicionamento do cursor (inclusive <a href="9a7c754c-2d72-4207-b3bd-2afc6047fb3d.htm">moveToCurrentRow</a>) for chamado no conjunto de resultados. O método <b>moveToInsertRow</b> coloca o conjunto de resultados efetivamente no modo de inserção, e os métodos de posicionamento do cursor terminam o modo de inserção. As chamadas de posicionamento relativo do cursor movem o cursor em relação à posição em que ele se encontrava antes de <b>moveToInsertRow</b> ser chamado. Após chamadas de posicionamento do cursor, a futura posição de destino do cursor se torna a nova posição do cursor.</p><p>Se a chamada de posicionamento do cursor feita no modo de inserção não for bem-sucedida, a posição do cursor após a chamada com falha será a posição original do cursor antes de <b>moveToInsetRow</b> ser chamado. Se ocorrer falha em <b>insertRow</b>, o cursor permanecerá na linha de inserção e no modo de inserção.</p><p>As colunas na linha de inserção estão inicialmente em um estado não inicializado. As chamadas para o método <b>update&lt;Type&gt;</b> definem o estado de coluna como inicializado. Uma chamada para o método <b>get&lt;Type&gt;</b> para uma coluna não inicializada lança uma exceção. Uma chamada para o método <b>insertRow</b> volta todas as colunas na linha de inserção a um estado não inicializado.</p><p>Se uma coluna estiver no estado não inicializado quando o método <b>insertRow</b> for chamado, será inserido o valor padrão da coluna. Se não houver um valor padrão, mas a coluna for anulável, será inserido NULL. Se não houver um valor padrão e a coluna não for anulável, o servidor retornará um erro e uma exceção será lançada.</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p /><p>As chamadas para o método <b>getRow</b> retornam 0 no modo de inserção. </p><p>O driver JDBC não oferece suporte a atualizações ou exclusões posicionadas. De acordo com a especificação do JDBC, o método <a href="3f3ec4f2-103a-4e16-9206-c5bd8639f946.htm">setCursorName</a> não tem nenhum efeito e o método <a href="e5b3af67-423a-4551-a4c6-a4bc076bd504.htm">getCursorName</a> lançará uma exceção se for chamado. </p><p>Os cursores somente leitura e estáticos nunca são atualizáveis. </p><p>O SQL Server restringe os cursores de servidor a um único conjunto de resultados. Se um procedimento em lote ou armazenado contiver várias instruções, um cursor de cliente somente encaminhamento e somente leitura deverá ser usado.</p></div></div><span id="seeAlsoSpan"><h1 class="heading">Consulte também</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="9ed5ad41-22e0-4e4a-8a79-10512db60d50.htm">Gerenciando conjuntos de resultados com o JDBC Driver</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Envie <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dObrigado%20por%20seus%20comentários.%20As%20equipes%20de%20desenvolvimento%20usam%20seus%20comentários%20para%20melhorar%20a%20documentação.%20Enquanto%20estivermos%20examinando%20seus%20comentários%20,%20poderemos%20enviar%20um%20email%20solicitando%20mais%20esclarecimentos%20ou%20comentários%20sobre%20a%20solução%20encontrada%20.%20Não%20usaremos%20seu%20endereço%20de%20email%20para%20nenhum%20outro%20propósito%20e%20o%20excluiremos%20após%20concluirmos%20a%20análise.%0\APara%20obter%20informações%20sobre%20a%20política%20de%20privacidade%20da%20Microsoft,%20consulte%20http://privacy.microsoft.com/pt-br/default.aspx.%0\A%0\d','Comentários%20do%20cliente.');">comentários</a> sobre este tópico à Microsoft.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft. Todos os direitos reservados.</a></p></span></div></div></body></html>
<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Programando com SQLXML</title><meta name="Language" content="pt-br" /><meta name="System.Keywords" content="buffer adaptável" /><meta name="System.Keywords" content="programando com sqlxml" /><meta name="System.Keywords" content="sqlxml" /><meta name="System.Keywords" content="xml" /><meta name="Microsoft.Help.Id" content="4d2cc57c-7293-4d92-b8b1-525e2b35f591" /><meta name="Description" content="Esta seção descreve como usar os métodos da API do Microsoft JDBC Driver para SQL Server para armazenar e recuperar um documento XML em e de um banco de dados relacional com objetos SQLXML." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Programando com SQLXML</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>Esta seção descreve como usar os métodos da API do Microsoft JDBC Driver para SQL Server para armazenar e recuperar um documento XML em e de um banco de dados relacional com objetos <span sdata="langKeyword" value="SQLXML"><span class="keyword">SQLXML</span></span>. </p><p>Além disso, ela contém informações sobre os tipos de objetos SQLXML e fornece uma lista de diretrizes e limitações importantes referentes ao uso desses objetos.</p></div><h1 class="heading">Lendo e escrevendo dados XML com objetos SQLXML</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>A seguinte lista descreve como usar os métodos da API do Microsoft JDBC Driver para SQL Server para ler e gravar dados XML com objetos SQLXML:</p><ul><li><p>Para criar um objeto SQLXML, use o método <a href="cf5bfcdd-bc03-4c5b-b554-d8a8a4067e93.htm">createSQLXML</a> da classe <a href="937292a6-1525-423e-a2b2-a18fd34c2893.htm">SQLServerConnection</a>. Observe que esse método cria um objeto SQLXML sem quaisquer dados. Para adicionar dados <span sdata="langKeyword" value="xml"><span class="keyword">xml</span></span> ao objeto SQLXML, chame um dos seguintes métodos que são especificados na interface SQLXML: <b>setResult</b>, <b>setCharacterStream</b>, <b>setBinaryStream</b> ou <b>setString</b>.</p></li><li><p>Para recuperar o objeto SQLXML propriamente dito, use os métodos <b>getSQLXML</b> da classe <a href="eaffcff1-286c-459f-83da-3150778480c9.htm">SQLServerResultSet</a> ou da classe <a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a>. </p></li><li><p>Para recuperar os dados <span sdata="langKeyword" value="xml"><span class="keyword">xml</span></span> de um objeto SQLXML, use um dos seguintes métodos que são especificados na interface SQLXML: <b>getSource</b>, <b>getCharacterStream</b>, <b>getBinaryStream</b> ou <b>getString</b>. </p></li><li><p>Para atualizar os dados <span sdata="langKeyword" value="xml"><span class="keyword">xml</span></span> em um objeto SQLXML, use o método <a href="abe8ff37-72e5-4ec1-a226-6b68dbf2c1b4.htm">updateSQLXML</a> da classe <a href="eaffcff1-286c-459f-83da-3150778480c9.htm">SQLServerResultSet</a>.</p></li><li><p>Para armazenar um objeto SQLXML em uma coluna de tabela de banco de dados do tipo <span sdata="langKeyword" value="xml"><span class="keyword">xml</span></span>, use os métodos <b>setSQLXML</b> da classe <a href="a8481c06-fbba-432b-8c69-4f4619c20ad4.htm">SQLServerPreparedStatement</a> ou da classe <a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a>.</p></li></ul><p>O código de exemplo em <a href="8f2ff25b-71fd-46d7-b6de-d656095d2aad.htm">Exemplo de tipo de dados SQLXML</a> demonstra como executar essas tarefas de API comuns. </p></div><h1 class="heading">Objetos SQLXML que podem ser lidos e escritos</h1><div id="sectionSection1" class="section" name="collapseableSection" style=""><p>A tabela a seguir relaciona os tipos de objetos SQLXML que têm suporte dos métodos de setter, getter e updater fornecidos pela API do JDBC. As colunas da tabela referem-se ao seguinte: </p><ul><li><p>A coluna <b>Nome do método</b> lista os métodos de getter, setter e updater que têm suporte na API do JDBC.</p></li><li><p>A coluna <b>Objeto SQLXML de getter</b> representa um objeto SQLXML que é criado pelo método <a href="8bcf9eda-b36c-480c-8bf2-91c392d5a0ee.htm">getSQLXML</a> da classe <a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a> ou pelo método <a href="a07e0f30-cbc6-4ad7-b931-c30cad382e64.htm">getSQLXML</a> da classe <a href="eaffcff1-286c-459f-83da-3150778480c9.htm">SQLServerResultSet</a>.</p></li><li><p>A coluna <b>Objeto SQLXML de setter</b> representa um objeto SQLXML que é criado pelo método <a href="cf5bfcdd-bc03-4c5b-b554-d8a8a4067e93.htm">createSQLXML</a> da classe <a href="937292a6-1525-423e-a2b2-a18fd34c2893.htm">SQLServerConnection</a>. Observe que os métodos de setter indicados abaixo só aceitam um objeto SQLXML criado pelo método <a href="cf5bfcdd-bc03-4c5b-b554-d8a8a4067e93.htm">createSQLXML</a>.</p></li></ul><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>Nome do método </p></th><th><p>Objeto SQLXML de getter</p><p>(pode ser lido)</p></th><th><p>Objeto SQLXML de setter</p><p>(pode ser escrito)</p></th></tr><tr><td><p><b>CallableStatement.setSQLXML()</b></p></td><td><p>Sem suporte</p></td><td><p>Com suporte</p></td></tr><tr><td><p><b>CallableStatement.setObject()</b></p></td><td><p>Sem suporte</p></td><td><p>Com suporte</p></td></tr><tr><td><p><b>PreparedStatement.setSQLXML()</b></p></td><td><p>Sem suporte</p></td><td><p>Com suporte</p></td></tr><tr><td><p><b>PreparedStatement.setObject()</b></p></td><td><p>Sem suporte</p></td><td><p>Com suporte</p></td></tr><tr><td><p><b>ResultSet.updateSQLXML()</b></p></td><td><p>Sem suporte</p></td><td><p>Com suporte</p></td></tr><tr><td><p><b>ResultSet.updateObject()</b></p></td><td><p>Sem suporte</p></td><td><p>Com suporte</p></td></tr><tr><td><p><b>ResultSet.getSQLXML()</b></p></td><td><p>Com suporte</p></td><td><p>Sem suporte</p></td></tr><tr><td><p><b>CallableStatement.getSQLXML()</b></p></td><td><p>Com suporte</p></td><td><p>Sem suporte</p></td></tr></table></div><p>Como mostrado na tabela acima, os métodos SQLXML de setter não funcionarão com os objetos SQLXML que podem ser lidos; da mesma forma, os métodos de getter não funcionarão com os objetos SQLXML que podem ser escritos.</p><p>Se o aplicativo invocar o método <b>setObject</b> especificando um parâmetro de escala ou comprimento com um objeto SQLXML, o parâmetro de escala ou comprimento será ignorado.</p></div><h1 class="heading">Diretrizes e limitações ao usar objetos SQLXML</h1><div id="sectionSection2" class="section" name="collapseableSection" style=""><p>Os aplicativos podem usar objetos SQLXML para ler e escrever os dados XML de e para o banco de dados. A lista a seguir fornece informações sobre limitações específicas e orientação quanto ao uso de objetos SQLXML: </p><ul><li><p>Um objeto SQLXML só pode ser válido pela duração da transação em que foi criado.</p></li><li><p>Um objeto SQLXML recebido de um método de getter só pode ser usado para ler dados. </p></li><li><p>Um objeto SQLXML criado pelo objeto de conexão só pode ser usado para escrever dados.</p></li><li><p>O aplicativo só pode invocar um único método de getter em um objeto SQLXML legível para ler dados. Depois que o método de getter for invocado, ocorrerá falha em todos os outros métodos de getter ou setter no mesmo objeto SQLXML. </p></li><li><p>O aplicativo só pode invocar o método <b>free</b> no objeto SQLXML depois que ele é lido ou escrito. Porém, ainda será possível processar a origem ou o fluxo retornado, contanto que a coluna ou o parâmetro subjacente esteja ativo. Se a coluna ou o parâmetro subjacente ficar inativo, a origem ou o fluxo associado com o objeto SQLXML será fechado. Se a coluna ou o parâmetro subjacente não for mais válido, os dados subjacentes não estarão disponíveis para os getters Fluxo, SAX (API Simples para XML) e StAX (API de Fluxo para XML).</p></li><li><p>O aplicativo só pode invocar um único método de setter em um objeto SQLXML que pode ser escrito. Depois que o método de setter for invocado, ocorrerá falha em todos os outros métodos de setter ou getter no mesmo objeto SQLXML.</p></li><li><p>Para definir dados no objeto SQLXML, o aplicativo deve usar o método de setter apropriado e as funções no objeto retornado.</p></li><li><p>Os métodos <b>getSQLXML</b> da classe <a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a> e da classe <a href="eaffcff1-286c-459f-83da-3150778480c9.htm">SQLServerResultSet</a> retornarão dados <span sdata="langKeyword" value="null"><span class="keyword">null</span></span> se a coluna subjacente for <span sdata="langKeyword" value="null"><span class="keyword">null</span></span>.</p></li><li><p>Os objetos de setter poderão ser válidos através da conexão dentro da qual forem criados.</p></li><li><p>Os aplicativos não têm permissão para definir um valor <span sdata="langKeyword" value="null"><span class="keyword">null</span></span> usando os métodos de setter fornecidos pela interface SQLXML. Os aplicativos podem definir uma cadeia de caracteres vazia ("") usando os métodos de setter fornecidos na interface SQLXML. Para definir um valor <span sdata="langKeyword" value="null"><span class="keyword">null</span></span>, os aplicativos devem chamar um dos seguintes itens:</p><ul><li><p>Os métodos <b>setNull</b> da classe <a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a> e da classe <a href="a8481c06-fbba-432b-8c69-4f4619c20ad4.htm">SQLServerPreparedStatement</a>.</p></li><li><p>Os métodos <b>setObject</b> da classe <a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a> e da classe <a href="a8481c06-fbba-432b-8c69-4f4619c20ad4.htm">SQLServerPreparedStatement</a>. </p></li><li><p>Os métodos <b>setSQLXML</b> da classe <a href="30710a63-c05d-47d9-9cf9-c087a1c76373.htm">SQLServerCallableStatement</a> e da classe <a href="a8481c06-fbba-432b-8c69-4f4619c20ad4.htm">SQLServerPreparedStatement</a> com um valor de parâmetro <span sdata="langKeyword" value="null"><span class="keyword">null</span></span>.</p></li></ul></li><li><p>Ao trabalhar com documentos XML, recomenda-se usar os analisadores SAX (API Simples para XML) e StAX (API de Fluxo para XML) em vez dos analisadores DOM (Document Object Model), por razões de desempenho.</p></li></ul><p>Os analisadores de XML não podem tratar valores vazios. Porém, o SQL Server permite que os aplicativos recuperem e armazenem valores vazios de e para colunas de banco de dados do tipo de dados XML. Isso significa que, ao analisar os dados XML, se o valor subjacente for vazio, uma exceção será lançada pelo analisador. Para saídas de DOM, o driver JDBC captura essa exceção e lança um erro. Para saídas de SAX e StAX, o erro vem diretamente do analisador.</p></div><h1 class="heading">Buffer adaptável e suporte a SQLXML</h1><div id="sectionSection3" class="section" name="collapseableSection" style=""><p>Os fluxos binário e de caracteres retornados pelo objeto SQLXML obedecem aos modos de buffer adaptável ou completo. Por outro lado, se os analisadores de XML não forem fluxos, eles não obedecerão às configurações de adaptável ou completo. Para obter mais informações sobre buffer adaptável, consulte <span sdata="link"><a href="92d4e3be-c3e9-4732-9a60-b57f4d0f7cb7.htm">Usando buffer adaptável</a></span>.</p></div><span id="seeAlsoSpan"><h1 class="heading">Consulte também</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="32b7217e-1f0c-473d-9a45-176daa81584e.htm">Dando suporte a dados XML</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Envie <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dObrigado%20por%20seus%20comentários.%20As%20equipes%20de%20desenvolvimento%20usam%20seus%20comentários%20para%20melhorar%20a%20documentação.%20Enquanto%20estivermos%20examinando%20seus%20comentários%20,%20poderemos%20enviar%20um%20email%20solicitando%20mais%20esclarecimentos%20ou%20comentários%20sobre%20a%20solução%20encontrada%20.%20Não%20usaremos%20seu%20endereço%20de%20email%20para%20nenhum%20outro%20propósito%20e%20o%20excluiremos%20após%20concluirmos%20a%20análise.%0\APara%20obter%20informações%20sobre%20a%20política%20de%20privacidade%20da%20Microsoft,%20consulte%20http://privacy.microsoft.com/pt-br/default.aspx.%0\A%0\d','Comentários%20do%20cliente.');">comentários</a> sobre este tópico à Microsoft.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft. Todos os direitos reservados.</a></p></span></div></div></body></html>
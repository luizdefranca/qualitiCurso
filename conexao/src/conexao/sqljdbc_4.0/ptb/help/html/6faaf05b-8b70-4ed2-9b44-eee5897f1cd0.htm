<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Usando JDBC Driver</title><meta name="Language" content="pt-br" /><meta name="System.Keywords" content="visão geral do driver JDBC, usando o driver JDBC" /><meta name="Microsoft.Help.Id" content="6faaf05b-8b70-4ed2-9b44-eee5897f1cd0" /><meta name="Description" content="Esta seção fornece instruções de início rápido para fazer uma conexão simples com um banco de dados do SQL Server usando o Microsoft JDBC Driver para SQL Server." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Usando JDBC Driver</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>Esta seção fornece instruções de início rápido para fazer uma conexão simples com um banco de dados do SQL Server usando o Microsoft JDBC Driver para SQL Server. Antes de você se conectar a um banco de dados do SQL Server, o SQL Server deve primeiro ser instalado no computador local ou em um servidor, e o driver JDBC deve ser instalado no computador local. </p></div><h1 class="heading">Escolhendo o arquivo JAR correto</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>O Microsoft JDBC Driver para SQL Server fornece os arquivos de biblioteca de classes <span sdata="langKeyword" value="sqljdbc.jar"><span class="keyword">sqljdbc.jar</span></span> e <span sdata="langKeyword" value="sqljdbc4.jar"><span class="keyword">sqljdbc4.jar</span></span> a serem usados de acordo com as suas configurações preferenciais do JRE (Java Runtime Environment). Para obter mais informações sobre qual arquivo JAR escolher, consulte <span sdata="link"><a href="447792bb-f39b-49b4-9fd0-1ef4154c74ab.htm">Requisitos de sistema para o JDBC Driver</a></span>.</p></div><h1 class="heading">Definindo o classpath</h1><div id="sectionSection1" class="section" name="collapseableSection" style=""><p>A driver JDBC não faz parte do Java SDK. Se você quiser usá-lo, é necessário definir o classpath para incluir o arquivo sqljdbc.jar ou o arquivo sqljdbc4.jar. Se no classpath faltar uma entrada para sqljdbc.jar ou sqljdbc4.jar, o seu aplicativo lançará a exceção comum "Class not found".</p><p>Os arquivos sqljdbc.jar e sqljdbc4.jar são instalados no seguinte local:</p><p>&lt;<span class="placeholder">installation directory</span>&gt;\sqljdbc_&lt;<span class="placeholder">version</span>&gt;\&lt;<span class="placeholder">language</span>&gt;\sqljdbc.jar</p><p>&lt;<span class="placeholder">installation directory</span>&gt;\sqljdbc_&lt;<span class="placeholder">version</span>&gt;\&lt;<span class="placeholder">language</span>&gt;\sqljdbc4.jar</p><p>A seguir, veja um exemplo da instrução CLASSPATH que é usada para um aplicativo do Windows:</p><p><span class="code">CLASSPATH =.;C:\Program Files\Microsoft JDBC Driver 4.0 for SQL Server\sqljdbc_4.0\enu\sqljdbc.jar</span></p><p>A seguir, veja um exemplo da instrução CLASSPATH que é usada para um aplicativo do Unix/Linux:</p><p><span class="code">CLASSPATH =.:/home/usr1/mssqlserverjdbc/Driver/sqljdbc_4.0/enu/sqljdbc.jar</span></p><p>Certifique-se de que a instrução CLASSPATH contenha apenas um Microsoft JDBC Driver para SQL Server, como sqljdbc.jar ou sqljdbc4.jar.</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Em sistemas Windows, nomes de diretórios mais longos que 8.3 ou nomes de pastas com espaços podem causar problemas com classpaths. Se você suspeitar destes tipos de problemas, mova temporariamente o arquivo sqljdbc.jar ou o arquivo sqljdbc4.jar para um diretório de nome simples como<span class="code"> C:\Temp</span>, altere o classpath e verifique se isso resolve o problema.</p></div><h1 class="heading">Aplicativos que são executados diretamente no prompt de comando</h1><div class="subsection"><p>O classpath é configurado no sistema operacional. Acrescente sqljdbc.jar ou sqljdbc4.jar ao classpath do sistema. Como alternativa, você pode especificar o classpath na linha de comando do Java que executa o aplicativo usando a opção<span class="code"> java -classpath </span>.</p></div><h1 class="heading">Aplicativos que executam em um IDE</h1><div class="subsection"><p>Cada fornecedor de IDE oferece um método diferente para definir o classpath em seu IDE. Apenas definir o classpath no sistema operacional não funcionará. Você deve acrescentar sqljdbc.jar ou sqljdbc4.jar ao classpath do IDE.</p></div><h1 class="heading">Servlets e JSPs</h1><div class="subsection"><p>Servlets e JSPs são executados em um mecanismo de servlet/JSP como, por exemplo, Tomcat. O classpath deve ser definido de acordo com a documentação de mecanismo de servlet/JSP. Apenas definir o classpath no sistema operacional não funcionará. Alguns mecanismos de servlet/JSP fornecem telas de instalação que você pode usar para definir o classpath do mecanismo. Nessa situação, você deve acrescentar o arquivo JAR correto do JDBC Driver ao classpath de mecanismo existente e deve reiniciar o mecanismo. Em outras situações, você pode implantar o driver copiando sqljdbc.jar ou sqljdbc4.jar em um diretório específico, por exemplo, lib, durante a instalação do mecanismo. O classpath do driver de mecanismo também pode ser especificado em um arquivo de configuração específico do mecanismo.</p></div><h1 class="heading">Enterprise Java Beans</h1><div class="subsection"><p>Enterprise Java Beans (EJB) são executados em um contêiner EJB. Contêineres EJB são originados de vários fornecedores. Miniaplicativos Java são executados em um navegador, mas são baixados de um servidor Web. Copie sqljdbc.jar ou sqljdbc4.jar para a raiz do servidor Web e especifique o nome do arquivo JAR no parâmetro HTML archive da tag do miniaplicativo, por exemplo, <span class="code">&lt;applet ... archive=sqljdbc.jar&gt;</span>.</p></div></div><h1 class="heading">Fazendo uma conexão simples com um banco de dados</h1><div id="sectionSection2" class="section" name="collapseableSection" style=""><p>Usando a biblioteca de classes sqljdbc.jar, os aplicativos devem primeiro registrar o driver como segue:</p><p><span class="code">Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");</span></p><p>Quando o driver é carregado, você pode estabelecer uma conexão usando uma URL de conexão e o método <b>getConnection</b> da classe <b>DriverManager</b>:</p><div class="sampleCode"><span codeLanguage="other"><pre>String connectionUrl = "jdbc:sqlserver://localhost:1433;" +
   "databaseName=AdventureWorks;user=MyUserName;password=*****;";
Connection con = DriverManager.getConnection(connectionUrl);</pre></span></div><p>Na API do JDBC 4.0, o método <b>DriverManager.getConnection</b> é aprimorado para carregar drivers de JDBC automaticamente. Portanto, aplicativos não precisam chamar o método <b>Class.forName</b> para registrar ou carregar o driver ao usar a biblioteca de classes sqljdbc4.jar.</p><p>Quando o método <b>getConnection</b> da classe <b>DriverManager</b> é chamado, um driver apropriado é localizado no conjunto de drivers JDBC registrados. O arquivo sqljdbc4.jar inclui o arquivo "META-INF/services/java.sql.Driver", que contém <span sdata="langKeyword" value="com.microsoft.sqlserver.jdbc.SQLServerDriver"><span class="keyword">com.microsoft.sqlserver.jdbc.SQLServerDriver</span></span> como um driver registrado. Os aplicativos existentes, que atualmente carregam os drivers usando o método <b>Class.forName</b> continuarão funcionando sem modificação.</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>A biblioteca de classes sqljdbc4.jar requer um JRE (Java Runtime Environment) de versão 6.0 ou posterior.</p></div><p>Para obter mais informações sobre como conectar-se com fontes de dados e usar uma URL de conexão, consulte <span sdata="link"><a href="44996746-d373-4f59-9863-a8a20bb8024a.htm">Construindo a URL de conexão</a></span> e <span sdata="link"><a href="f1b62700-f046-488d-bd6b-a5cd8fc345b7.htm">Definindo as propriedades de conexão</a></span>.</p></div><span id="seeAlsoSpan"><h1 class="heading">Consulte também</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="939a8773-2583-49a4-bf00-6b892fbe39dc.htm">Visão geral do JDBC Driver</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Envie <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dObrigado%20por%20seus%20comentários.%20As%20equipes%20de%20desenvolvimento%20usam%20seus%20comentários%20para%20melhorar%20a%20documentação.%20Enquanto%20estivermos%20examinando%20seus%20comentários%20,%20poderemos%20enviar%20um%20email%20solicitando%20mais%20esclarecimentos%20ou%20comentários%20sobre%20a%20solução%20encontrada%20.%20Não%20usaremos%20seu%20endereço%20de%20email%20para%20nenhum%20outro%20propósito%20e%20o%20excluiremos%20após%20concluirmos%20a%20análise.%0\APara%20obter%20informações%20sobre%20a%20política%20de%20privacidade%20da%20Microsoft,%20consulte%20http://privacy.microsoft.com/pt-br/default.aspx.%0\A%0\d','Comentários%20do%20cliente.');">comentários</a> sobre este tópico à Microsoft.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft. Todos os direitos reservados.</a></p></span></div></div></body></html>
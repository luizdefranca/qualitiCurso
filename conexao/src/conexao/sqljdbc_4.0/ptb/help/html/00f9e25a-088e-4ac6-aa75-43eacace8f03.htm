<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Usando sequências de escape do SQL</title><meta name="Language" content="pt-br" /><meta name="System.Keywords" content="Sequências de escape do SQL" /><meta name="Microsoft.Help.Id" content="00f9e25a-088e-4ac6-aa75-43eacace8f03" /><meta name="Description" content="O Microsoft JDBC Driver para SQL Server oferece suporte ao uso de sequências de escape do SQL, conforme definido pela API do JDBC." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Usando sequências de escape do SQL</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>O Microsoft JDBC Driver para SQL Server oferece suporte ao uso de sequências de escape do SQL, conforme definido pela API do JDBC. As sequências de escape são usadas em uma instrução SQL para informar ao driver que a parte de escape da cadeia de caracteres SQL deve ser tratada de forma diferente. Quando o driver JDBC processa a parte de escape de uma cadeia de caracteres SQL, ele converte essa parte da cadeia de caracteres em código SQL que o SQL Server entende. </p><p>Há cinco tipos de sequências de escape requeridas pela API JDBC e todos têm o suporte do driver JDBC:</p><ul><li><p>Literais do curinga LIKE</p></li><li><p>Manipulação de função</p></li><li><p>Literais de data e hora</p></li><li><p>Chamadas de procedimento armazenado</p></li><li><p>Junções externas</p></li></ul><p>A sintaxe da sequência de escape usada pelo driver JDBC é a seguinte:</p><p><span class="code">{keyword ...parameters...}</span></p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>O processamento de escape do SQL sempre está ativado para o driver JDBC.</p></div><p>As seções a seguir descrevem os cinco tipos de sequências de escape e como elas têm o suporte do driver JDBC.</p></div><h1 class="heading">Literais do curinga LIKE</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>O driver JDBC dá suporte à sintaxe <span class="code">{escape 'escape character'}</span> para uso de curingas da cláusula LIKE como literais. Por exemplo, o código a seguir retornará valores para col3, onde o valor de col2 começa literalmente com um sublinhado (e não seu uso de curinga).</p><div class="sampleCode"><span codeLanguage="other"><pre>ResultSet rst = stmt.executeQuery("SELECT col3 FROM test1 WHERE col2 
LIKE '\\_%' {escape '\\'}");</pre></span></div><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>A sequência de escape deve estar no fim da instrução SQL. Para várias instruções SQL em uma cadeia de caracteres de comando, a sequência de escape precisa estar no fim de cada instrução SQL pertinente.</p></div></div><h1 class="heading">Manipulação de função</h1><div id="sectionSection1" class="section" name="collapseableSection" style=""><p>O driver JDBC dá suporte às sequências de escape de função em instruções SQL com a seguinte sintaxe:</p><div class="sampleCode"><span codeLanguage="other"><pre>{fn functionName}</pre></span></div><p>onde <span class="code">functionName</span> é uma função que tem o suporte do driver JDBC. Por exemplo:</p><div class="sampleCode"><span codeLanguage="other"><pre>SELECT {fn UCASE(Name)} FROM Employee</pre></span></div><p>A tabela a seguir lista as várias funções que têm o suporte do driver JDBC ao usar uma sequência de escape de função:</p><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>Funções de cadeia de caracteres</p></th><th><p>Funções numéricas</p></th><th><p>Funções de data e hora</p></th><th><p>Funções de sistema</p></th></tr><tr><td><p>ASCII</p><p>CHAR</p><p>CONCAT</p><p>DIFFERENCE</p><p>INSERT</p><p>LCASE</p><p>LEFT</p><p>LENGTH</p><p>LOCATE</p><p>LTRIM</p><p>REPEAT</p><p>REPLACE</p><p>RIGHT</p><p>RTRIM</p><p>SOUNDEX</p><p>SPACE</p><p>SUBSTRING</p><p>UCASE</p></td><td><p>ABS</p><p>ACOS</p><p>ASIN</p><p>ATAN</p><p>ATAN2</p><p>CEILING</p><p>COS</p><p>COT</p><p>DEGREES</p><p>EXP</p><p>FLOOR</p><p>LOG</p><p>LOG10</p><p>MOD</p><p>PI</p><p>POWER</p><p>RADIANS</p><p>RAND</p><p>ROUND</p><p>SIGN</p><p>SIN</p><p>SQRT</p><p>TAN</p><p>TRUNCATE</p></td><td><p>CURDATE</p><p>CURTIME</p><p>DAYNAME</p><p>DAYOFMONTH</p><p>DAYOFWEEK</p><p>DAYOFYEAR</p><p>EXTRACT</p><p>HOUR</p><p>MINUTE</p><p>MONTH</p><p>MONTHNAME</p><p>NOW</p><p>QUARTER</p><p>SECOND</p><p>TIMESTAMPADD</p><p>TIMESTAMPDIFF</p><p>WEEK</p><p>YEAR</p></td><td><p>DATABASE</p><p>IFNULL</p><p>USER</p></td></tr></table></div><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Se você tentar usar uma função que não tenha o suporte do banco de dados, ocorrerá um erro.</p></div></div><h1 class="heading">Literais de data e hora</h1><div id="sectionSection2" class="section" name="collapseableSection" style=""><p>A sintaxe de escape para data, hora e literais de carimbo de data/hora é a seguinte: </p><div class="sampleCode"><span codeLanguage="other"><pre>{literal-type 'value'}</pre></span></div><p>onde <span class="code">literal-type</span> é um destes:</p><div class="tableSection"><table width="50%" cellspacing="2" cellpadding="5" frame="lhs"><tr><th><p>Tipo de literal</p></th><th><p>Descrição</p></th><th><p>Formato do valor</p></th></tr><tr><td><p>d</p></td><td><p>Data</p></td><td><p>aaaa-mm-dd</p></td></tr><tr><td><p>t</p></td><td><p>Hora</p></td><td><p>hh:mm:ss [1]</p></td></tr><tr><td><p>ts</p></td><td><p>Carimbo de data/hora</p></td><td><p>aaaa-mm-dd hh:mm:ss[.f...]</p></td></tr></table></div><p>Por exemplo:</p><div class="sampleCode"><span codeLanguage="other"><pre>UPDATE Orders SET OpenDate={d '2005-01-31'} 
WHERE OrderID=1025</pre></span></div></div><h1 class="heading">Chamadas de procedimento armazenado</h1><div id="sectionSection3" class="section" name="collapseableSection" style=""><p>O driver JDBC dá suporte às sintaxes de escape <span class="code">{? = call proc_name(?,...)}</span> e <span class="code">{call proc_name(?,...)}</span> para chamadas de procedimento armazenado, dependendo da necessidade de processar um parâmetro de retorno. </p><p>Um procedimento é um objeto executável armazenado no banco de dados. Em geral, é uma ou mais instruções SQL que foram pré-compiladas. A sintaxe da sequência de escape para chamar um procedimento armazenado é a seguinte: </p><div class="sampleCode"><span codeLanguage="other"><pre>{[?=]call procedure-name[([parameter][,[parameter]]...)]}</pre></span></div><p>onde <span class="code">procedure-name</span> especifica o nome de um procedimento armazenado e <span class="code">parameter</span> especifica um parâmetro de procedimento armazenado.</p><p>Para obter mais informações sobre como usar a sequência de escape <span class="code">call</span> com procedimentos armazenados, consulte <span sdata="link"><a href="0041f9e1-09b6-4487-b052-afd636c8e89a.htm">Usando instruções com procedimentos armazenados</a></span>.</p></div><h1 class="heading">Junções externas</h1><div id="sectionSection4" class="section" name="collapseableSection" style=""><p>O driver JDBC dá suporte à sintaxe de junção externa esquerda, direita e completa do SQL92. A sequência de escape de junções externas é a seguinte:</p><div class="sampleCode"><span codeLanguage="other"><pre>{oj outer-join}</pre></span></div><p>onde outer-join é:</p><div class="sampleCode"><span codeLanguage="other"><pre>table-reference {LEFT | RIGHT | FULL} OUTER JOIN  
{table-reference | outer-join} ON search-condition</pre></span></div><p>onde <span class="code">table-reference</span> é um nome de tabela e <span class="code">search-condition</span> é a condição de junção que você deseja usar para as tabelas.</p><p>Por exemplo:</p><div class="sampleCode"><span codeLanguage="other"><pre>SELECT Customers.CustID, Customers.Name, Orders.OrderID, Orders.Status 
   FROM {oj Customers LEFT OUTER JOIN 
      Orders ON Customers.CustID=Orders.CustID} 
   WHERE Orders.Status='OPEN'</pre></span></div><p>As seguintes sequências de escape de junção externa têm o suporte do driver JDBC:</p><ul><li><p>Junções externas esquerdas</p></li><li><p>Junções externas direitas</p></li><li><p>Junções externas completas</p></li><li><p>Junções externas aninhadas</p></li></ul></div><span id="seeAlsoSpan"><h1 class="heading">Consulte também</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="7f8f3e8f-841e-4449-9154-b5366870121f.htm">Usando instruções com o JDBC Driver</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Envie <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dObrigado%20por%20seus%20comentários.%20As%20equipes%20de%20desenvolvimento%20usam%20seus%20comentários%20para%20melhorar%20a%20documentação.%20Enquanto%20estivermos%20examinando%20seus%20comentários%20,%20poderemos%20enviar%20um%20email%20solicitando%20mais%20esclarecimentos%20ou%20comentários%20sobre%20a%20solução%20encontrada%20.%20Não%20usaremos%20seu%20endereço%20de%20email%20para%20nenhum%20outro%20propósito%20e%20o%20excluiremos%20após%20concluirmos%20a%20análise.%0\APara%20obter%20informações%20sobre%20a%20política%20de%20privacidade%20da%20Microsoft,%20consulte%20http://privacy.microsoft.com/pt-br/default.aspx.%0\A%0\d','Comentários%20do%20cliente.');">comentários</a> sobre este tópico à Microsoft.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft. Todos os direitos reservados.</a></p></span></div></div></body></html>
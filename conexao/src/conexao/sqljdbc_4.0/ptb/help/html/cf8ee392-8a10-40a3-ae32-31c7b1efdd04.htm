<html xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:mshelp="http://msdn.microsoft.com/mshelp" xmlns:ddue="http://ddue.schemas.microsoft.com/authoring/2003/5" xmlns:msxsl="urn:schemas-microsoft-com:xslt"><head><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=UTF-8" /><META NAME="save" CONTENT="history" /><title>Trabalhando com uma conexão</title><meta name="Language" content="pt-br" /><meta name="System.Keywords" content="conexão" /><meta name="Microsoft.Help.Id" content="cf8ee392-8a10-40a3-ae32-31c7b1efdd04" /><meta name="Description" content="As seções a seguir fornecem exemplos dos modos diferentes de se conectar a um banco de dados do SQL Server usando a classe SQLServerConnection do Microsoft JDBC Driver para SQL Server." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><link rel="stylesheet" type="text/css" href="../local/Classic.css" /><script type="text/javascript" src="../scripts/EventUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/SplitScreen.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/Dropdown.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_manifold.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/script_feedBack.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CheckboxMenu.js">&amp;nbsp;</script><script type="text/javascript" src="../scripts/CommonUtilities.js">&amp;nbsp;</script><script type="text/javascript" src="../local/script_main.js">&amp;nbsp;</script></head><body><div id="header"><table id="bottomTable" cellpadding="0" cellspacing="0"><tr><td align="left"><span id="headerBold">Trabalhando com uma conexão</span></td></tr></table><table id="gradientTable"><tr><td class="nsrBottom" background="../icons/gradient.gif" /></tr></table></div><div id="mainSection"><div id="mainBody"><div class="introduction"><p>As seções a seguir fornecem exemplos dos modos diferentes de se conectar a um banco de dados do SQL Server usando a classe <a href="937292a6-1525-423e-a2b2-a18fd34c2893.htm">SQLServerConnection</a> do Microsoft JDBC Driver para SQL Server.</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Se você tiver problemas para se conectar ao SQL Server usando o driver JDBC, consulte <a href="bfba0b49-2e1f-411d-a625-d25fad9ea12d.htm">Solucionando problemas de conectividade</a> para obter sugestões de como corrigir isto.</p></div></div><h1 class="heading">Criando uma conexão usando a classe DriverManager</h1><div id="sectionSection0" class="section" name="collapseableSection" style=""><p>A abordagem mais simples para criar uma conexão com um banco de dados do SQL Server é carregar o driver JDBC e chamar o método <b>getConnection</b> da classe <b>DriverManager</b>, da seguinte maneira:</p><div class="sampleCode"><span codeLanguage="other"><pre>Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");
String connectionUrl = "jdbc:sqlserver://localhost;database=AdventureWorks;integratedSecurity=true;"
Connection con = DriverManager.getConnection(connectionUrl);</pre></span></div><p>Esta técnica criará uma conexão de banco de dados usando o primeiro driver disponível na lista de drivers que podem se conectar com êxito à URL fornecida.</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Ao usar a biblioteca de classes sqljdbc4.jar, os aplicativos não precisam registrar explicitamente ou carregar o driver usando o método <b>Class.forName</b>. Quando o método <b>getConnection</b> da classe <b>DriverManager</b> é chamado, um driver apropriado é localizado no conjunto de drivers JDBC registrados. Para obter mais informações, consulte Usando JDBC Driver.</p></div></div><h1 class="heading">Criando uma conexão usando a classe SQLServerDriver</h1><div id="sectionSection1" class="section" name="collapseableSection" style=""><p>Se você tiver que especificar um driver específico na lista de drivers para <b>DriverManager</b>, poderá criar uma conexão de banco de dados usando o método <a href="43813a4c-1cc7-4659-ba27-f1786f1371eb.htm">connect</a> da classe <a href="fbdceae5-7e7b-4edb-8c33-c701ca6b2d53.htm">SQLServerDriver</a>, da seguinte maneira:</p><div class="sampleCode"><span codeLanguage="other"><pre>Driver d = (Driver) Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver").newInstance();
String connectionUrl = "jdbc:sqlserver://localhost;database=AdventureWorks;integratedSecurity=true;"
Connection con = d.connect(connectionUrl, new Properties());</pre></span></div></div><h1 class="heading">Criando uma conexão usando a classe SQLServerDataSource</h1><div id="sectionSection2" class="section" name="collapseableSection" style=""><p>Se você tiver que criar uma conexão usando a classe <a href="097434fd-2b74-411c-a5ed-eba04481dde5.htm">SQLServerDataSource</a>, poderá usar vários métodos setter da classe antes de chamar o método <a href="7f520e96-5313-468f-b987-535ddaea027e.htm">getConnection</a>, da seguinte maneira:</p><div class="sampleCode"><span codeLanguage="other"><pre>SQLServerDataSource ds = new SQLServerDataSource();
ds.setUser("MyUserName");
ds.setPassword("*****");
ds.setServerName("localhost");
ds.setPortNumber(1433); 
ds.setDatabaseName("AdventureWorks");
Connection con = ds.getConnection();</pre></span></div></div><h1 class="heading">Criando uma conexão com destino a uma fonte de dados muito específica</h1><div id="sectionSection3" class="section" name="collapseableSection" style=""><p>Para fazer uma conexão de banco de dados com destino a uma fonte de dados muito específica, há várias abordagens. Cada abordagem depende das propriedades que você define usando a URL de conexão.</p><p>Para conectar-se à instância padrão em um servidor remoto, use o seguinte:</p><p><span class="code">String url = "jdbc:sqlserver://MyServer;integratedSecurity=true;"</span></p><p>Para conectar-se a uma porta específica em um servidor, use o seguinte:</p><p><span class="code">String url = "jdbc:sqlserver://MyServer:1533;integratedSecurity=true;"</span></p><p>Para conectar-se a uma instância nomeada em um servidor, use o seguinte:</p><p><span class="code">String url = "jdbc:sqlserver://209.196.43.19;instanceName=INSTANCE1;integratedSecurity=true;"</span></p><p>Para conectar-se a um banco de dados específico em um servidor, use o seguinte:</p><p><span class="code">String url = "jdbc:sqlserver://172.31.255.255;database=AdventureWorks;integratedSecurity=true;"</span></p><p>Para obter mais exemplos de URLs de conexão, consulte <span sdata="link"><a href="44996746-d373-4f59-9863-a8a20bb8024a.htm">Construindo a URL de conexão</a></span>.</p></div><h1 class="heading">Criando uma conexão com um tempo limite de logon personalizado</h1><div id="sectionSection4" class="section" name="collapseableSection" style=""><p>Se você tiver que ajustar para carga de servidor ou tráfego de rede, poderá criar uma conexão que tem um valor de tempo limite de logon específico descrita em segundos, da seguinte maneira:</p><p><span class="code">String url = "jdbc:sqlserver://MyServer;loginTimeout=90;integratedSecurity=true;"</span></p></div><h1 class="heading">Criar uma conexão com identidade de nível de aplicativo</h1><div id="sectionSection5" class="section" name="collapseableSection" style=""><p>Se você tiver que usar log e perfil, terá que identificar sua conexão como originária de um aplicativo específico, da seguinte maneira:</p><p><span class="code">String url = "jdbc:sqlserver://MyServer;applicationName=MYAPP.EXE;integratedSecurity=true;"</span></p></div><h1 class="heading">Fechando uma conexão</h1><div id="sectionSection6" class="section" name="collapseableSection" style=""><p>Você pode fechar uma conexão de banco de dados explicitamente chamando o método <a href="f0f26585-bdf7-4737-b434-8c7e115c8e94.htm">close</a> da classe <b>SQLServerConnection</b>, da seguinte maneira:</p><p><span class="code">con.close();</span></p><p>Isto liberará os recursos de banco de dados que o objeto <b>SQLServerConnection</b> está usando ou retornará a conexão para o pool de conexão em cenários em pool.</p><div style="margin: .5em 1.5em .5em 1.5em"><b></b><p>Chamar o método <b>close</b> também reverterá qualquer transação pendente.</p></div></div><span id="seeAlsoSpan"><h1 class="heading">Consulte também</h1></span><div id="seeAlsoSection" class="section" name="collapseableSection" style=""><div class="seeAlsoStyle"><span sdata="link"><a href="94bcfbe3-f00e-4774-bda8-bb7577518fec.htm">Conectando ao SQL Server com o JDBC Driver</a></span></div></div></div><div id="footer" class="section"><span id="feedbackarea">Envie <a href="javascript:SubmitFeedback('DevDocs@Microsoft.com','','','','8.0.12060.10000','%0\dObrigado%20por%20seus%20comentários.%20As%20equipes%20de%20desenvolvimento%20usam%20seus%20comentários%20para%20melhorar%20a%20documentação.%20Enquanto%20estivermos%20examinando%20seus%20comentários%20,%20poderemos%20enviar%20um%20email%20solicitando%20mais%20esclarecimentos%20ou%20comentários%20sobre%20a%20solução%20encontrada%20.%20Não%20usaremos%20seu%20endereço%20de%20email%20para%20nenhum%20outro%20propósito%20e%20o%20excluiremos%20após%20concluirmos%20a%20análise.%0\APara%20obter%20informações%20sobre%20a%20política%20de%20privacidade%20da%20Microsoft,%20consulte%20http://privacy.microsoft.com/pt-br/default.aspx.%0\A%0\d','Comentários%20do%20cliente.');">comentários</a> sobre este tópico à Microsoft.</span><span id="copyrightarea"><p><a href="9bad553b-9e70-4696-8499-2e35f772a1e0.htm">© 2012 Microsoft. Todos os direitos reservados.</a></p></span></div></div></body></html>